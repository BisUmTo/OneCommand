# Initialization score
scoreboard players add @a 033lvl 0
scoreboard players add @a 033dts 0

# Disable Recipes
advancement grant @a from minecraft:recipes/root
recipe take @a *

# Killing Waypoint
execute at @e[type=item,nbt={Item:{tag:{display:{Name:"§f§k§l~§e§o§l Level Waypoint §f§k§l~§r"}}}}] run title @p actionbar ["",{"text":"The waypoint n.","bold":true,"color":"dark_red"},{"score":{"name":"@e[tag=033lvl,distance=..1,limit=1]","objective":"033lvl"},"bold":true,"color":"dark_red"},{"text":" has been removed.","bold":true,"color":"dark_red"}]
execute at @e[type=item,nbt={Item:{tag:{display:{Name:"§f§k§l~§e§o§l Level Waypoint §f§k§l~§r"}}}}] as @e[tag=033lvl,distance=..1] at @s run summon minecraft:item ~ ~ ~ {Item:{id:"minecraft:armor_stand",Count:1b,tag:{ench:[{id:90,lvl:0}],display:{Name:"§f§k§l~§e§o§l Level Waypoint §f§k§l~§r",Lore:["§7Place this armor_stand to add a level.§r","§7Drop this armor_stand to remove it.§r"]},EntityTag:{NoGravity:1,Invisible:1,Marker:1,Tags:["033lvl"]}}},Motion:[0.0d,0.3d,0.0d],PickupDelay:18,Tags:["033nll"]}
execute at @e[type=item,nbt={Item:{tag:{display:{Name:"§f§k§l~§e§o§l Level Waypoint §f§k§l~§r"}}}}] run kill @e[tag=033lvl,distance=..1]

# Adding Waypoint
tag @e[tag=033lvl,tag=!033slc] add 033add
scoreboard players set @e[tag=033lvl] 033lvl 0
tag @e[tag=033slc] remove 033slc
execute if entity @e[tag=033lvl,tag=!033slc] run function dtd:loop
execute as @e[tag=033add] run title @p actionbar ["",{"text":"The waypoint n.","bold":true,"color":"dark_green"},{"score":{"name":"@s","objective":"033lvl"},"bold":true,"color":"dark_green"},{"text":" has been added.","bold":true,"color":"dark_green"}]
tag @e[tag=033add] remove 033add

# Drop Crafting
execute at @e[tag=!033cr0,type=minecraft:item,nbt={OnGround:1b,Item:{id:"minecraft:yellow_banner",Count:1b}}] as @e[type=minecraft:item,distance=..1,limit=1,nbt={OnGround:1b,Item:{id:"minecraft:armor_stand",Count:1b}}] run playsound minecraft:block.anvil.use block @a
execute at @e[tag=!033cr0,type=minecraft:item,nbt={OnGround:1b,Item:{id:"minecraft:yellow_banner",Count:1b}}] as @e[type=minecraft:item,distance=..1,limit=1,nbt={OnGround:1b,Item:{id:"minecraft:armor_stand",Count:1b}}] store success entity @s Age short 6000 run summon minecraft:item ~ ~ ~ {Item:{id:"minecraft:armor_stand",Count:1b,tag:{ench:[{id:90,lvl:0}],display:{Name:"§f§k§l~§e§o§l Level Waypoint §f§k§l~§r",Lore:["§7Place this armor_stand to add a level.§r","§7Drop this armor_stand to remove it.§r"]},EntityTag:{NoGravity:1,Invisible:1,Marker:1,Tags:["033lvl"]}}},Motion:[0.0d,0.3d,0.0d],Tags:["033cr0","033cr1"],PickupDelay:18}
execute at @e[tag=033cr1] as @e[type=minecraft:item,limit=1,nbt={OnGround:1b,Item:{id:"minecraft:yellow_banner",Count:1b}}] store success entity @s Age short 6000 run tag @e[tag=033cr1] remove 033cr1

execute at @e[tag=!033cr0,type=minecraft:item,nbt={OnGround:1b,Item:{id:"minecraft:lime_banner",Count:1b}}] as @e[type=minecraft:item,distance=..1,limit=1,nbt={OnGround:1b,Item:{id:"minecraft:sign",Count:1b}}] run playsound minecraft:block.anvil.use block @a
execute at @e[tag=!033cr0,type=minecraft:item,nbt={OnGround:1b,Item:{id:"minecraft:lime_banner",Count:1b}}] as @e[type=minecraft:item,distance=..1,limit=1,nbt={OnGround:1b,Item:{id:"minecraft:sign",Count:1b}}] store success entity @s Age short 6000 run summon minecraft:item ~ ~ ~ {Item:{id:"minecraft:sign",Count:1b,tag:{ench:[{id:90,lvl:0}],BlockEntityTag:{Text1:"{\"text\":\"\",\"clickEvent\":{\"action\":\"run_command\",\"value\":\"scoreboard players add @s 033lvl 1\"}}",Text2:"[{\"text\":\"\",\"clickEvent\":{\"action\":\"run_command\",\"value\":\"scoreboard players operation @p 033trg = @s 033lvl\"}},{\"text\":\"~\",\"obfuscated\":true,\"color\":\"white\"},{\"text\":\" \"},{\"text\":\"Next Level\",\"color\":\"green\",\"bold\":true},{\"text\":\" \"},{\"text\":\"~\",\"obfuscated\":true,\"color\":\"white\"}]",Text3:"{\"text\":\"\",\"clickEvent\":{\"action\":\"run_command\",\"value\":\"playsound minecraft:entity.player.levelup player @s\"}}",Text4:"{\"text\":\"\",\"clickEvent\":{\"action\":\"run_command\",\"value\":\"title @a title [\\\"\\\",{\\\"text\\\":\\\"Level \\\",\\\"color\\\":\\\"white\\\"},{\\\"score\\\":{\\\"name\\\":\\\"@s\\\",\\\"objective\\\":\\\"033lvl\\\"},\\\"color\\\":\\\"white\\\"}]\"}}"},display:{Name:"§f§k§l~§a§o§l Next Level §f§k§l~§r",Lore:["§7Place this sign to add a§r","§7Next-Level button.§r"]}}},Motion:[0.0d,0.3d,0.0d],Tags:["033cr0","033cr2"],PickupDelay:18}
execute at @e[tag=033cr2] as @e[type=minecraft:item,limit=1,nbt={OnGround:1b,Item:{id:"minecraft:lime_banner",Count:1b}}] store success entity @s Age short 6000 run tag @e[tag=033cr2] remove 033cr2

execute at @e[tag=!033cr0,type=minecraft:item,nbt={OnGround:1b,Item:{id:"minecraft:red_banner",Count:1b}}] as @e[type=minecraft:item,distance=..1,limit=1,nbt={OnGround:1b,Item:{id:"minecraft:sign",Count:1b}}] run playsound minecraft:block.anvil.use block @a
execute at @e[tag=!033cr0,type=minecraft:item,nbt={OnGround:1b,Item:{id:"minecraft:red_banner",Count:1b}}] as @e[type=minecraft:item,distance=..1,limit=1,nbt={OnGround:1b,Item:{id:"minecraft:sign",Count:1b}}] store success entity @s Age short 6000 run summon minecraft:item ~ ~ ~ {Item:{id:"minecraft:sign",Count:1b,tag:{ench:[{id:90,lvl:0}],BlockEntityTag:{Text1:"{\"text\":\"\",\"clickEvent\":{\"action\":\"run_command\",\"value\":\"trigger 033trg set -1\"}}",Text2:"[{\"text\":\"\",\"clickEvent\":{\"action\":\"run_command\",\"value\":\"playsound minecraft:ui.toast.challenge_complete player @s ~ ~ ~ 100 0\"}},{\"text\":\"~\",\"obfuscated\":true,\"color\":\"white\"},{\"text\":\" Reset \",\"bold\":true,\"color\":\"dark_red\"},{\"text\":\"~\",\"obfuscated\":true,\"color\":\"white\"}]"},display:{Name:"§f§k§l~§4§o§l Reset §f§k§l~§r",Lore:["§7Place this sign to add a§r","§7Reset button.§r"]}}},Motion:[0.0d,0.3d,0.0d],Tags:["033cr0","033cr3"],PickupDelay:18}
execute at @e[tag=033cr3] as @e[type=minecraft:item,limit=1,nbt={OnGround:1b,Item:{id:"minecraft:red_banner",Count:1b}}] store success entity @s Age short 6000 run tag @e[tag=033cr3] remove 033cr3

execute at @e[tag=!033cr0,type=minecraft:item,nbt={OnGround:1b,Item:{id:"minecraft:light_blue_banner",Count:1b}}] as @e[type=minecraft:item,distance=..1,limit=1,nbt={OnGround:1b,Item:{id:"minecraft:sign",Count:1b}}] run playsound minecraft:block.anvil.use block @a
execute at @e[tag=!033cr0,type=minecraft:item,nbt={OnGround:1b,Item:{id:"minecraft:light_blue_banner",Count:1b}}] as @e[type=minecraft:item,distance=..1,limit=1,nbt={OnGround:1b,Item:{id:"minecraft:sign",Count:1b}}] store success entity @s Age short 6000 run summon minecraft:item ~ ~ ~ {Item:{id:"minecraft:sign",Count:1b,tag:{ench:[{id:90,lvl:0}],BlockEntityTag:{Text1:"{\"text\":\"\",\"clickEvent\":{\"action\":\"run_command\",\"value\":\"playsound minecraft:ui.toast.challenge_complete player @s ~ ~ ~ 100 1.25\"}}",Text2:"[{\"text\":\"\",\"clickEvent\":{\"action\":\"run_command\",\"value\":\"title @s title {\\\"title\\\":\\\"You Won!\\\"}\"}},{\"text\":\"~\",\"obfuscated\":true,\"color\":\"white\"},{\"text\":\" Finish \",\"bold\":true,\"color\":\"aqua\"},{\"text\":\"~\",\"obfuscated\":true,\"color\":\"white\"}]",Text3:"{\"text\":\"\",\"clickEvent\":{\"action\":\"run_command\",\"value\":\"gamemode spectator @s\"}}",Text4:"{\"text\":\"\",\"clickEvent\":{\"action\":\"run_command\",\"value\":\"trigger 033trg set -1\"}}"},display:{Name:"§f§k§l~§b§o§l Finish §f§k§l~§r",Lore:["§7Place this sign to add a§r","§7Finish button.§r"]}}},Motion:[0.0d,0.3d,0.0d],Tags:["033cr0","033cr4"],PickupDelay:18}
execute at @e[tag=033cr4] as @e[type=minecraft:item,limit=1,nbt={OnGround:1b,Item:{id:"minecraft:light_blue_banner",Count:1b}}] store success entity @s Age short 6000 run tag @e[tag=033cr4] remove 033cr4

execute at @e[tag=!033cr0,type=minecraft:item,nbt={OnGround:1b,Item:{id:"minecraft:green_banner",Count:1b}}] as @e[type=minecraft:item,distance=..1,limit=1,nbt={OnGround:1b,Item:{id:"minecraft:sign",Count:1b}}] run playsound minecraft:block.anvil.use block @a
execute at @e[tag=!033cr0,type=minecraft:item,nbt={OnGround:1b,Item:{id:"minecraft:green_banner",Count:1b}}] as @e[type=minecraft:item,distance=..1,limit=1,nbt={OnGround:1b,Item:{id:"minecraft:sign",Count:1b}}] store success entity @s Age short 6000 run summon minecraft:item ~ ~ ~ {Item:{id:"minecraft:sign",Count:1b,tag:{ench:[{id:90,lvl:0}],BlockEntityTag:{Text1:"{\"text\":\"\",\"clickEvent\":{\"action\":\"run_command\",\"value\":\"scoreboard players add @s 033lvl 1\"}}",Text2:"[{\"text\":\"\",\"clickEvent\":{\"action\":\"run_command\",\"value\":\"scoreboard players operation @p 033trg = @s 033lvl\"}},{\"text\":\"~\",\"obfuscated\":true,\"color\":\"white\"},{\"text\":\" Start \",\"color\":\"dark_green\",\"bold\":true},{\"text\":\"~\",\"obfuscated\":true,\"color\":\"white\"}]",Text3:"{\"text\":\"\",\"clickEvent\":{\"action\":\"run_command\",\"value\":\"playsound minecraft:entity.player.levelup player @s\"}}",Text4:"{\"text\":\"\",\"clickEvent\":{\"action\":\"run_command\",\"value\":\"title @a title [\\\"\\\",{\\\"text\\\":\\\"Level \\\",\\\"color\\\":\\\"white\\\"},{\\\"score\\\":{\\\"name\\\":\\\"@s\\\",\\\"objective\\\":\\\"033lvl\\\"},\\\"color\\\":\\\"white\\\"}]\"}}"},display:{Name:"§f§k§l~§2§o§l Start §f§k§l~§r",Lore:["§7Place this sign to add a§r","§7Start button.§r"]}}},Motion:[0.0d,0.3d,0.0d],Tags:["033cr0","033cr5"],PickupDelay:18}
execute at @e[tag=033cr5] as @e[type=minecraft:item,limit=1,nbt={OnGround:1b,Item:{id:"minecraft:green_banner",Count:1b}}] store success entity @s Age short 6000 run tag @e[tag=033cr5] remove 033cr5

# Fire
execute as @a store result score @s 033frt run data get entity @s Fire 1
kill @a[scores={033frt=1..}]

# Trigger and Death
scoreboard players enable @a 033trg
execute as @a[scores={033trg=1..}] run scoreboard players operation @s 033lvl = @s 033trg
execute as @a[scores={033hlt=..19}] run scoreboard players operation @s 033trg = @s 033lvl
execute as @a store result score @s 033dth run data get entity @s DeathTime
scoreboard players add @a[scores={033hlt=..19,033dth=..1}] 033dts 1
playsound minecraft:entity.shulker.death player @a[scores={033hlt=..19,033dth=..1}] ~ ~ ~ 100 0.7
execute as @e[tag=033lvl] run scoreboard players operation @s 033trg = @s 033lvl
execute as @a[scores={033trg=1..},limit=1] run scoreboard players operation @e[tag=033lvl] 033trg -= @s 033trg
execute as @e[tag=033lvl,scores={033trg=0}] run tp @a[scores={033trg=1..},limit=1] @s
execute as @a[scores={033trg=1..},limit=1] at @s run spawnpoint @s
execute as @e[tag=033lvl,scores={033trg=0}] run effect give @a[scores={033hlt=..19},limit=1] minecraft:instant_health 1 20 true
scoreboard players set @a[scores={033trg=1..},limit=1] 033trg 0
scoreboard players remove @a[scores={033frt=1..}] 033dts 1

# Waypoint Particles
execute at @e[tag=033lvl] run particle minecraft:block lime_concrete ~ ~ ~ 0 0 0 0.1 2
execute at @e[tag=033lvl] run particle minecraft:block yellow_concrete ~ ~ ~ .01 .01 .01 0.01 1

# Special trigger
execute as @a[scores={033trg=-1}] run scoreboard players set @a 033dts 0
execute as @a[scores={033trg=-1}] run scoreboard players set @a 033lvl 0

execute as @a[scores={033trg=-2}] run give @s chest{BlockEntityTag:{CustomName:"    §f§k~§r§1 §lDon't Take Damage§r §f§k~§r",Items:[{Slot: 2b,id:"minecraft:armor_stand",Count: 1b},{Slot: 3b,id:"minecraft:sign",Count: 1b},{Slot: 4b,id:"minecraft:sign",Count: 1b},{Slot: 5b,id:"minecraft:sign",Count: 1b},{Slot: 6b,id:"minecraft:sign",Count: 1b},{Slot: 11b,id:"minecraft:yellow_banner",Count: 1b},{Slot: 12b,id:"minecraft:green_banner",Count: 1b},{Slot: 13b,id:"minecraft:lime_banner",Count: 1b},{Slot: 14b,id:"minecraft:red_banner",Count: 1b},{Slot: 15b,id:"minecraft:light_blue_banner",Count: 1b},{Slot: 20b,id:"minecraft:armor_stand",Count: 1b,tag:{ench:[{lvl: 0,id: 90}],display:{Lore:["§7Place this armor_stand to add a level.§r","§7Drop this armor_stand to remove it.§r"],Name:"§f§k§l~§e§o§l Level Waypoint §f§k§l~§r"},EntityTag:{NoGravity: 1,Invisible: 1,Marker: 1,Tags:["033lvl"]}}},{Slot: 21b,id:"minecraft:sign",Count: 1b,tag:{ench:[{lvl: 0,id: 90}],BlockEntityTag:{Text4:"{\"text\":\"\",\"clickEvent\":{\"action\":\"run_command\",\"value\":\"title @a title [\\\"\\\",{\\\"text\\\":\\\"Level \\\",\\\"color\\\":\\\"white\\\"},{\\\"score\\\":{\\\"name\\\":\\\"@s\\\",\\\"objective\\\":\\\"033lvl\\\"},\\\"color\\\":\\\"white\\\"}]\"}}",Text3:"{\"text\":\"\",\"clickEvent\":{\"action\":\"run_command\",\"value\":\"playsound minecraft:entity.player.levelup player @s\"}}",Text2:"[{\"text\":\"\",\"clickEvent\":{\"action\":\"run_command\",\"value\":\"scoreboard players operation @p 033trg = @s 033lvl\"}},{\"text\":\"~\",\"obfuscated\":true,\"color\":\"white\"},{\"text\":\" Start \",\"color\":\"dark_green\",\"bold\":true},{\"text\":\"~\",\"obfuscated\":true,\"color\":\"white\"}]",Text1:"{\"text\":\"\",\"clickEvent\":{\"action\":\"run_command\",\"value\":\"scoreboard players add @s 033lvl 1\"}}"},display:{Lore:["§7Place this sign to add a§r","§7Start button.§r"],Name:"§f§k§l~§2§o§l Start §f§k§l~§r"}}},{Slot: 22b,id:"minecraft:sign",Count: 1b,tag:{ench:[{lvl: 0,id: 90}],BlockEntityTag:{Text4:"{\"text\":\"\",\"clickEvent\":{\"action\":\"run_command\",\"value\":\"title @a title [\\\"\\\",{\\\"text\\\":\\\"Level \\\",\\\"color\\\":\\\"white\\\"},{\\\"score\\\":{\\\"name\\\":\\\"@s\\\",\\\"objective\\\":\\\"033lvl\\\"},\\\"color\\\":\\\"white\\\"}]\"}}",Text3:"{\"text\":\"\",\"clickEvent\":{\"action\":\"run_command\",\"value\":\"playsound minecraft:entity.player.levelup player @s\"}}",Text2:"[{\"text\":\"\",\"clickEvent\":{\"action\":\"run_command\",\"value\":\"scoreboard players operation @p 033trg = @s 033lvl\"}},{\"text\":\"~\",\"obfuscated\":true,\"color\":\"white\"},{\"text\":\" \"},{\"text\":\"Next Level\",\"color\":\"green\",\"bold\":true},{\"text\":\" \"},{\"text\":\"~\",\"obfuscated\":true,\"color\":\"white\"}]",Text1:"{\"text\":\"\",\"clickEvent\":{\"action\":\"run_command\",\"value\":\"scoreboard players add @s 033lvl 1\"}}"},display:{Lore:["§7Place this sign to add a§r","§7Next-Level button.§r"],Name:"§f§k§l~§a§o§l Next Level §f§k§l~§r"}}},{Slot: 23b,id:"minecraft:sign",Count: 1b,tag:{ench:[{lvl: 0,id: 90}],BlockEntityTag:{Text2:"[{\"text\":\"\",\"clickEvent\":{\"action\":\"run_command\",\"value\":\"playsound minecraft:ui.toast.challenge_complete player @s ~ ~ ~ 100 0\"}},{\"text\":\"~\",\"obfuscated\":true,\"color\":\"white\"},{\"text\":\" Reset \",\"bold\":true,\"color\":\"dark_red\"},{\"text\":\"~\",\"obfuscated\":true,\"color\":\"white\"}]",Text1:"{\"text\":\"\",\"clickEvent\":{\"action\":\"run_command\",\"value\":\"trigger 033trg set -1\"}}"},display:{Lore:["§7Place this sign to add a§r","§7Reset button.§r"],Name:"§f§k§l~§4§o§l Reset §f§k§l~§r"}}},{Slot: 24b,id:"minecraft:sign",Count: 1b,tag:{ench:[{lvl: 0,id: 90}],BlockEntityTag:{Text4:"{\"text\":\"\",\"clickEvent\":{\"action\":\"run_command\",\"value\":\"trigger 033trg set -1\"}}",Text3:"{\"text\":\"\",\"clickEvent\":{\"action\":\"run_command\",\"value\":\"gamemode spectator @s\"}}",Text2:"[{\"text\":\"\",\"clickEvent\":{\"action\":\"run_command\",\"value\":\"title @s title {\\\"title\\\":\\\"You Won!\\\"}\"}},{\"text\":\"~\",\"obfuscated\":true,\"color\":\"white\"},{\"text\":\" Finish \",\"bold\":true,\"color\":\"aqua\"},{\"text\":\"~\",\"obfuscated\":true,\"color\":\"white\"}]",Text1:"{\"text\":\"\",\"clickEvent\":{\"action\":\"run_command\",\"value\":\"playsound minecraft:ui.toast.challenge_complete player @s ~ ~ ~ 100 1.25\"}}"},display:{Lore:["§7Place this sign to add a§r","§7Finish button.§r"],Name:"§f§k§l~§b§o§l Finish §f§k§l~§r"}}}],id:"minecraft:chest",Lock:""},display:{Name:"§f§k~§r§1 §lDon't Take Damage§r §f§k~§r"}}
scoreboard players set @a[scores={033trg=..-1}] 033trg 0

# Action bar
execute as @a[scores={033lvl=1..}] run title @s actionbar ["",{"text":"Level:","bold":true,"italic":true,"color":"gray"},{"text":" ","italic":true,"color":"gray"},{"score":{"name":"@s","objective":"033lvl"},"italic":true,"color":"gray"},{"text":" - ","italic":true,"color":"gray"},{"text":"Deaths:","bold":true,"italic":true,"color":"gray"},{"text":" ","italic":true,"color":"gray"},{"score":{"name":"@s","objective":"033dts"},"italic":true,"color":"gray"}]
